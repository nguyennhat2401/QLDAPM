{% extends 'layout/admin_base.html' %}
{% block admin_body %}
<div class="d-flex justify-content-between align-items-center mb-2">
  <h4>Lịch sử nạp tiền</h4>
  <div class="h6 mb-0">Tổng nạp đã duyệt:
    <b>{{ "{:,.0f}".format(topup_revenue or 0) }} VND</b>
  </div>
</div>

<div class="card">
  <div class="table-responsive">
    <table class="table table-sm mb-0">
      <thead>
        <tr>
          <th>ID</th><th>User</th><th>Số tiền</th><th>Trạng thái</th>
          <th>Thời gian</th><th>Nội dung CK</th><th>Biên lai</th>
        </tr>
      </thead>
      <tbody>
      {% for p in topups %}
        <tr>
          <td>{{ p.id }}</td>
          <td>{{ p.user_id }}</td>
          <td>{{ "{:,.0f}".format(p.amount or 0) }}</td>
          <td>{{ p.status.name }}</td>
          <td>{{ p.paymentDate.strftime("%d-%m-%Y %H:%M") if p.paymentDate else "" }}</td>
          <td>{{ p.note }}</td>
          <td>{% if p.proof %}<a href="/{{ p.proof }}" target="_blank">Xem</a>{% else %}—{% endif %}</td>
        </tr>
      {% else %}
        <tr><td colspan="7" class="text-muted p-3">Chưa có giao dịch.</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<nav class="mt-3">
  <ul class="pagination">
    {% for i in range(1, (pages or 1) + 1) %}
      <li class="page-item {{ 'active' if i == (page or 1) else '' }}">
        <a class="page-link" href="{{ url_for('admin_topups', page=i) }}">{{ i }}</a>
      </li>
    {% endfor %}
  </ul>
</nav>
{% endblock %}
